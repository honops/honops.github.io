<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>配置企业微信发送蓝鲸告警信息 | 厚诺技术团队</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="honops"><meta name="designer" content="minfive"><meta name="keywords" content="blog, devops, k8s, go, 蓝鲸, 监控, CMDB, ITSM"><meta name="description" content="专注DevOps，智能运维及云服务"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://tech.honops.com/2020/03/26/blueking-wework/index.html"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="厚诺科技"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d0e25934bf1ea1aef0e9d8517467221a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/scss/views/page/post.css"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="厚诺科技" type="application/atom+xml"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(https://blog.static.minfive.com/other/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="厚诺科技" alt="厚诺科技"><img src="/img/logo.png" alt="厚诺科技"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="https://uploads.sxlcdn.com/static/backgrounds/cityscape/155.jpg" alt="配置企业微信发送蓝鲸告警信息"></div><header class="post__info"><h1 class="post__title">配置企业微信发送蓝鲸告警信息</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/">李柱</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2020-03-26</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a></li><li class="mark__item"><a href="/tags/%E5%91%8A%E8%AD%A6/">告警</a></li><li class="mark__item"><a href="/tags/%E6%95%85%E9%9A%9C%E8%87%AA%E6%84%88/">故障自愈</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>次</li></ul></div></div></header><div class="post__content"><p>蓝鲸故障自愈介绍</p><p>在蓝鲸平台上，故障自愈是行业领先的”故障自动化处理”解决方案，提升企业的服务可用性和降低故障处理的人力投入，实现故障自愈从”人工处理”到”无人值守”的变革!通过自动化处理节省人力投入，通过预定的恢复流程让恢复过程更可靠，通过并行分析达到更快的故障定位和恢复。一句话概括：实时发现告警，预诊断分析，自动恢复故障，并打通周边系统实现整个流程的闭环。</p><p>对于大多数使用类似监控之类运维工具的企业，大多都是通过邮件或者短信发送告警通知，收到告警后，一般还需要运维人员人工介入处理。腾讯蓝鲸可以通过在蓝鲸平台配置企业微信，蓝鲸监控结合故障自愈神器，当故障发生时实时触发微信告警，并执行预诊断分析，自动恢复故障。同时，高危或重要操作可以加入人工审批功能。</p><p>本篇文章主要介绍蓝鲸平台下，微信告警网关的详细配置过程，下一篇文章会介绍如何在企业微信中实现故障自愈的人工审批。</p><p>环境</p><p>蓝鲸版本：企业版 2.2.9[社区版类似]<br>测试时间：2019年7月<br>前提条件</p><p>开通企业微信，点击跳转注册页面<br>可以通过公网直接访问蓝鲸平台，并且蓝鲸平台可以访问公网<br>企业微信配置</p><ol><li>使用管理员，通过web浏览器登录企业微信。登录地址：<a href="https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome" target="_blank" rel="noopener">https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome</a></li></ol><p>注意：</p><p>打开链接后，通过移动端企业微信，扫描二维码登录。<br>使用管理员权限，普通用户无法登陆。<br>2. 查看最下方的“企业ID”字段</p><p>注意：记录“企业ID”字段的信息，待会儿配置微信网关的时候会用到。</p><ol start="3"><li>点击“应用与小程序”，填入关键字段信息，点击“创建应用”即可。</li></ol><p>注意：</p><p>记录“AgentId”和“Secret”字段的信息，配置微信网关的时候会用到。<br>需要哪些用户通过企业微信收到告警通知，在“可见范围”中选择他即可。<br>4. 配置回调域名，点击下方的“企业微信授权登录”，对“Web网页”配置授权回调域。可以理解为，“允许该域名下的请求，访问企业微信的开发者接口。”</p><p>注意：对于蓝鲸平台来讲，回调域是“paas域名”+“端口”。</p><p>蓝鲸平台配置</p><ol><li>配置微信网关</li></ol><p>打开蓝鲸Paas平台 -&gt; 开发者中心 -&gt; 通道管理 -&gt; 蓝鲸消息管理 -&gt; 发送微信信息</p><p>注意：使用管理员配置。<br>wx_type：微信类型，选择企业微信<br>wx_qy_corpid：企业ID字段信息<br>wx_qy_corpsecret：Secret字段信息<br>wx_qy_agentid：AgentId字段信息</p><ol start="2"><li>配置接受告警人员的企业微信账号<br>打开蓝鲸Paas平台 -&gt; 个人中心 -&gt; 绑定微信</li></ol><p>注意：</p><p>现在是配置接收告警人员的账号，建议使用不要用admin用户。<br>需要接受微信告警的用户，将其蓝鲸账号，绑定对应的企业微信即可。<br>如果收不到微信告警，请检查企业微信中的“可见范围”，是否正确。<br>通过移动端的企业微信，扫描弹出的二维码，实现蓝鲸账户和企业微信账户绑定。<br>如果刚才配置企业微信的时候，没有配置回调域，此时可能会弹出“redirect_uri 与配置的授权完成回调域名不一致”的报错。如果遇到，请检查一下回调域，是否配置正确。<br>3. 配置告警策略<br>在蓝鲸监控、故障自愈中配置告警策略，使其通过微信发送告警。详细配置，此处不再赘言，可以参考蓝鲸监控白皮书 <a href="https://docs.bk.tencent.com/bk_monitor/Host_Monitor_Trigger_Old.html" target="_blank" rel="noopener">https://docs.bk.tencent.com/bk_monitor/Host_Monitor_Trigger_Old.html</a></p><p>注意：</p><p>要保证蓝鲸监控可以正常触发告警，如有异常，可以通过蓝鲸监控首页“近期告警时间中查看详情。<br>蓝鲸监控的默认的告警策略是发给“主机”的主负责人和备负责人。<br>测试验证</p><p>在蓝鲸监控中，手动触发告警，通过企业微信查看告警信息</p><p>至此，蓝鲸平台完成对接企业微信的配置。</p><div class="post-announce">感谢您的阅读，本文由 <a href="http://tech.honops.com">厚诺科技</a> 版权所有。如若转载，请注明出处：厚诺科技（<a href="http://tech.honops.com/2020/03/26/blueking-wework/">http://tech.honops.com/2020/03/26/blueking-wework/</a>）</div><div class="post__prevs"><div class="post__prev"></div><div class="post__prev post__prev--right"><a href="/2020/03/26/blueking-cd/" title="利用蓝鲸标准运维实现应用自动发布（持续交付）">利用蓝鲸标准运维实现应用自动发布（持续交付）<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">专注DevOps，智能运维及云服务</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><span class="block-list-count">3</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2020/03/26/blueking-oracle-dataguard/" title="利用蓝鲸标准运维实现Oracle DataGuard一键切换"><div class="item__cover"><img src="https://unsplash.sxlcdn.com/photo-1524749292158-7540c2494485?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&h=1500&w=2000&fit=clip&fm=jpg" alt="利用蓝鲸标准运维实现Oracle DataGuard一键切换"></div><div class="item__info"><h3 class="item__title">利用蓝鲸标准运维实现Oracle DataGuard一键切换</h3><span class="item__text">2020-03-26</span></div></a></li><li class="latest-post-item"><a href="/2020/03/26/blueking-cd/" title="利用蓝鲸标准运维实现应用自动发布（持续交付）"><div class="item__cover"><img src="https://unsplash.sxlcdn.com/photo-1423666639041-f56000c27a9a?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&h=540&w=540&fit=clip&fm=jpg" alt="利用蓝鲸标准运维实现应用自动发布（持续交付）"></div><div class="item__info"><h3 class="item__title">利用蓝鲸标准运维实现应用自动发布（持续交付）</h3><span class="item__text">2020-03-26</span></div></a></li><li class="latest-post-item"><a href="/2020/03/26/blueking-wework/" title="配置企业微信发送蓝鲸告警信息"><div class="item__cover"><img src="https://uploads.sxlcdn.com/static/backgrounds/cityscape/155.jpg" alt="配置企业微信发送蓝鲸告警信息"></div><div class="item__info"><h3 class="item__title">配置企业微信发送蓝鲸告警信息</h3><span class="item__text">2020-03-26</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/oracle/">oracle</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E5%91%8A%E8%AD%A6/">告警</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E6%95%85%E9%9A%9C%E8%87%AA%E6%84%88/">故障自愈</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E6%A0%87%E5%87%86%E8%BF%90%E7%BB%B4/">标准运维</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83/">自动发布</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">© 2020 厚诺技术团队 All rights reserved.</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Zhengzhou, Henan Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>tech@honops.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="http://user-assets.sxlcdn.com/images/501804/FpWyg-ZoIRsGEYFLSKZseer5H3k_.JPG?imageMogr2/strip/auto-orient/thumbnail/720x1440%3E/quality/90!/interlace/1/format/jpg" alt="logo" title="厚诺科技"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><ul class="footer__social-network clearfix"></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["运维","告警","故障自愈"],gitalk=new Gitalk({clientID:"ac9ff9e5f691b2c60922",clientSecret:"076fa62a85b76a83dc8dd8a1209b07b4b106b64e",repo:"https://github.com/honops/blog-comment.git",owner:"honopsgit",admin:["honopsgit"],labels:tags,id:new Date(1585205259e3).getTime()>new Date("2018-02-15").getTime()?md5(location.href):location.href});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>