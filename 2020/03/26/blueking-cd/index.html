<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>利用蓝鲸标准运维实现应用自动发布（持续交付） | 厚诺技术团队</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="honops"><meta name="designer" content="minfive"><meta name="keywords" content="blog, devops, k8s, go, 蓝鲸, 监控, CMDB, ITSM"><meta name="description" content="专注DevOps，智能运维及云服务"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://tech.honops.com/2020/03/26/blueking-cd/index.html"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="厚诺科技"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d0e25934bf1ea1aef0e9d8517467221a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/scss/views/page/post.css"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="厚诺科技" type="application/atom+xml"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(https://blog.static.minfive.com/other/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="厚诺科技" alt="厚诺科技"><img src="/img/logo.png" alt="厚诺科技"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="https://unsplash.sxlcdn.com/photo-1423666639041-f56000c27a9a?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&h=540&w=540&fit=clip&fm=jpg" alt="利用蓝鲸标准运维实现应用自动发布（持续交付）"></div><header class="post__info"><h1 class="post__title">利用蓝鲸标准运维实现应用自动发布（持续交付）</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/">宋延鹏</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2020-03-26</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a></li><li class="mark__item"><a href="/tags/%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83/">自动发布</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>次</li></ul></div></div></header><div class="post__content"><p>在上一篇文章《利用蓝鲸标准运维实现Oracle DataGuard一键切换》文章中，我们介绍了利用标准运维实现Oracle ADG切换的场景。本文是蓝鲸标准运维使用场景的第二篇，通过一个企业常见的应用发布场景，介绍标准运维在发版流程编排方面的使用。</p><p>标准运维简介</p><p>蓝鲸智云，简称蓝鲸，是腾讯游戏运营部“腾讯智营”下的子品牌。它是一套基于PaaS的企业研发运营一体化技术解决方案，提供了一个完整的研发、运维、运营的PaaS技术平台。平台提供了完善的前后台开发框架、调度引擎、公共组件等模块，帮助业务的产品和技术人员快速构建低成本、免运维的支撑工具和运营系统；是腾讯游戏运营部沉淀多年的技术运营支撑体系，承担着数百款业务线上运营的使命。</p><p>标准运维是一套通过成熟稳定的任务调度引擎，把多系统间的工作整合到一个流程，助力运维实现跨系统调度自动化的’SaaS’应用。标准运维拥有可视化的图形界面，用户可通过它实现任务流程编排和执行，包括发布、变更、开区、扩缩容等执行类操作场景。</p><p>简而言之，蓝鲸是监管控一体的PaaS运维平台，标准运维是蓝鲸平台其中的一个官方SaaS。</p><p>厚诺蓝鲸标准运维<br>用户可以通过对标准插件节点、子流程节点与网关节点的组合，变量的配置与引用，配置出一个业务流程。</p><p>厚诺蓝鲸，标准运维画布<br>厚诺蓝鲸，标准运维流程设置<br>厚诺蓝鲸，标准运维流程设置<br>为什么需要应用自动发布</p><p>随着业务的不断发展，企业应用系统也变得越来越复杂，不同应用厂商，其背后研发团队间的技术栈，如所使用的开发语言、开发框架、操作系统、数据库等技术组合，以及发布变更、故障处理等运维操作场景和操作流程，都是不同的。应用架构的差异性和复杂性，也给 CI/CD 应用在包交付模式和灵活的编排上提出更多的挑战；</p><p>另外研发与运维团队职责不同和环境差异化，经常导致研发人员在对配置或环境进行修改之后，不会及时告知运维人员；而运维人员发布应用时，由于对运行环境和应用的内部细节缺乏了解，难以正确选择运行环境和控制发布流程，往往会遇到各种各样的问题，沟通成本非常高。</p><p>同时，业务要求更频繁的发布，如果仅仅依靠运维人员的手工部署，一方面效率低、易出错，另外也无法满足不断增加的应用系统和部署环境。所以，开发人员对自助发布的需求越来越强烈，希望能够通过自助平台实现一键发布。</p><p>通过蓝鲸标准运维实现持续交付</p><p>依托蓝鲸管控平台，以及上面介绍的流程编排利器标准运维来实现应用自动发布。（蓝鲸管控平台是整个蓝鲸平台的底层管控系统，是蓝鲸所有其他服务的基础。管控平台通过Agent为蓝鲸其他平台提供了人机交互的通道与能力。蓝鲸管控平台主要提供了三种类型的服务能力：文件分发传输能力、命令实时执行与反馈的能力、大数据采集与传输的能力。）</p><p>以下图为例，通过标准运维对应用发布流程进行分解，分解后的每个步骤可以包含多个原子，依次进行代码拉取，备份，以及分发文件等操作。我们可以根据固化的发布流程来创建任务，每个任务都是一次真正的业务场景作业，任务可以被暂停、被强制终止。通过标准运维的助力，实现更可靠的发布，提高部署频率，与业务目标保持紧密一致。</p><p>厚诺蓝鲸，标准运维，画布<br>实际案例</p><p>下面以厚诺在某金融行业客户交付的实际案例为例，简单介绍一下通过标准运维完成应用发版的设计过程。为了演示方便，这里对发版过程进行了一些简化：</p><p>厚诺科技，应用发布流程<br>以上发版流程简单来说，就是运维人员从开发人员那里拿到包，分发到应用服务器对应的位置，然后执行解压、重启等到一系列操作。</p><p>虽然以上操作貌似简单，但是设想一下，如果发版是在凌晨两点的时候进行呢？如果每天待发版的系统有数十套之多呢？纯手工按照文档一步一步操作，稍不注意，可能就会出错且效率极低。虽然对于一些简单的场景，可以通过写一些脚本，来简化操作。可是，如果脚本的健壮性不好，或者人为误操作，传错了包等问题，还是会存在很大的安全风险。</p><p>可能经验丰富、水平较高的运维工程师，会想到通过Ansible、Puppet等开源的自动化运维工具来操作。但这些工具对初学者还是有一定的门槛，操作界面的友好程度也不足，无论是Ansible的Playbook语法，还是SaltStack的State语法，都是需要学习成本，某些情况下甚至要研究源码。</p><p>如果使用蓝鲸的标准运维，运维人员可以通过可视化的图形界面，利用标准运维强悍的跨系统编排能力，来串连碎片步骤从而提高发布效率，极大的降低人员误操作的风险。流程的整个编排过程非常容易上手，一次编排，多次使用。开发人员即便不熟悉CI/CD 工具，仍可直接使用平台提供的多种流水线模板，来创建符合自身业务需求的流水线，满足不同工作场景和特有的业务需求，大幅度提高工作效率。</p><p>先看下最终流程编排的效果：</p><p>厚诺蓝鲸，标准运维<br>设计过程</p><p>厚诺科技，蓝鲸标准运维<br>过程说明：</p><p>将包在测试环境部署，验证通过后，将测试包，流转到到生产环境的仓库。到了发版时间，运维人员点击，新建任务，执行即可。<br>通过（shell、python、bat、perl）脚本，验证此次发版包的信息，名称、MD5、时间等信息，如果信息不匹配，发送告警通知后暂停，等待相关人员介入。<br>通过作业平台，分发文件到多个主机，如果由于未知原因造成分发失败，可以发送告警通知后暂停，等待相关人员介入，也可以执行“重试”操作。<br>编写部署脚本，进行小批量部署，如果有一台部署失败，便会发送告警通知，然后暂停，等待相关人员介入或者跳过。<br>检验试部署无误后，便可以进行大批量部署。同样的，如果某一台因为意外情况发版失败，便会告警通知。<br>发版结束后，会发送通知信息，通知管理员此次发版结束。<br>可以看到，通过标准运维编排固化后的发版流程，具有以下特点：</p><p>整个流程执行过程中，每一步操作如果失败，都会及时触发告警，运维人员可以快速定位故障；<br>通过图形界面实时展示任务执行状态，直观地感知当前任务的进度；<br>运维人员可以选择执行发版操作的节点，比如只更新部分主机；<br>避免登录服务器，降低人为误操作风险；<br>用户在任务记录页面，可以追溯之前的任务执行情况；<br>用户可以选择上面的流程模板创建出一个轻应用，这个轻应用可以在蓝鲸PaaS的应用市场中打开或添加到桌面，对使用人员而言，轻应用只需要关注一个流程模板的参数填写和任务操作，由于页面足够的简洁和友好，一个非技术人员也可以通过轻应用执行任务，这也就是标准运维提供的自助化服务之一。<br>标准运维为用户提供了“职能化中心”功能，可以让运维将业务日常标准化的发布、变更等工作交给职能化人员（业务操作员，负责实施运维工作中常规性、重复性的操作）来操作，让业务运维有更多时间和精力去优化和提升业务的质量和体验。<br>可以对其进行二次开发。比如支持定时自动发版等，开发自己适用的标准运维插件，实现真正的无人值守。<br>厚诺科技，标准运维，应用发布<br>总结</p><p>以上只是一个简化后的发版流程，用户可以在以上示例的基础上，轻松扩展和定制满足自身需求的任意场景，包括：</p><p>运维场景：发布、变更、开区、扩缩容，资源交付、容灾切换等执行类操作<br>其他场景：监控告警、配置管理、开发工具、企业IT、办公应用、其它</p><div class="post-announce">感谢您的阅读，本文由 <a href="http://tech.honops.com">厚诺科技</a> 版权所有。如若转载，请注明出处：厚诺科技（<a href="http://tech.honops.com/2020/03/26/blueking-cd/">http://tech.honops.com/2020/03/26/blueking-cd/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2020/03/26/blueking-wework/" title="配置企业微信发送蓝鲸告警信息"><i class="iconfont icon-prev"></i>配置企业微信发送蓝鲸告警信息</a></div><div class="post__prev post__prev--right"><a href="/2020/03/26/blueking-oracle-dataguard/" title="利用蓝鲸标准运维实现Oracle DataGuard一键切换">利用蓝鲸标准运维实现Oracle DataGuard一键切换<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">专注DevOps，智能运维及云服务</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><span class="block-list-count">3</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2020/03/26/blueking-oracle-dataguard/" title="利用蓝鲸标准运维实现Oracle DataGuard一键切换"><div class="item__cover"><img src="https://unsplash.sxlcdn.com/photo-1524749292158-7540c2494485?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&h=1500&w=2000&fit=clip&fm=jpg" alt="利用蓝鲸标准运维实现Oracle DataGuard一键切换"></div><div class="item__info"><h3 class="item__title">利用蓝鲸标准运维实现Oracle DataGuard一键切换</h3><span class="item__text">2020-03-26</span></div></a></li><li class="latest-post-item"><a href="/2020/03/26/blueking-cd/" title="利用蓝鲸标准运维实现应用自动发布（持续交付）"><div class="item__cover"><img src="https://unsplash.sxlcdn.com/photo-1423666639041-f56000c27a9a?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&h=540&w=540&fit=clip&fm=jpg" alt="利用蓝鲸标准运维实现应用自动发布（持续交付）"></div><div class="item__info"><h3 class="item__title">利用蓝鲸标准运维实现应用自动发布（持续交付）</h3><span class="item__text">2020-03-26</span></div></a></li><li class="latest-post-item"><a href="/2020/03/26/blueking-wework/" title="配置企业微信发送蓝鲸告警信息"><div class="item__cover"><img src="https://uploads.sxlcdn.com/static/backgrounds/cityscape/155.jpg" alt="配置企业微信发送蓝鲸告警信息"></div><div class="item__info"><h3 class="item__title">配置企业微信发送蓝鲸告警信息</h3><span class="item__text">2020-03-26</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/oracle/">oracle</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E5%91%8A%E8%AD%A6/">告警</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E6%95%85%E9%9A%9C%E8%87%AA%E6%84%88/">故障自愈</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E6%A0%87%E5%87%86%E8%BF%90%E7%BB%B4/">标准运维</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83/">自动发布</a></li><li class="tag-item"><a class="tag-link" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">© 2020 厚诺技术团队 All rights reserved.</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Zhengzhou, Henan Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>tech@honops.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="http://user-assets.sxlcdn.com/images/501804/FpWyg-ZoIRsGEYFLSKZseer5H3k_.JPG?imageMogr2/strip/auto-orient/thumbnail/720x1440%3E/quality/90!/interlace/1/format/jpg" alt="logo" title="厚诺科技"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><ul class="footer__social-network clearfix"></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["运维","自动发布"],gitalk=new Gitalk({clientID:"5e9037d903b1e5ef6be6",clientSecret:"2f92253ec1ea0570ccd2c57f457949bb0ed6b66f",repo:"honops-blog-comment",owner:"honopsgit",admin:["honopsgit"],labels:tags,id:new Date(1585208859e3).getTime()>new Date("2018-02-15").getTime()?md5(location.href):location.href});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>